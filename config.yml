# Global configuration for Claude Code custom features
# Location: ${CLAUDE_PATH}/config.yml (project root)

# Cloud provider authentication settings
cloud_providers:
  aws:
    enabled: true
    display_name: "AWS"
    description: "Amazon Web Services SSO"
    config_file: .aws.yml
    prompt_at_start: true

  gcp:
    enabled: true
    display_name: "GCP"
    description: "Google Cloud Platform"
    prompt_at_start: true

project_metadata:
  # Session history settings
  session_history_limit: 10          # Keep last N sessions per project

  # Auto-update settings
  auto_update_on_session: true       # Update on session start
  periodic_refresh_hours: 24         # Periodic refresh interval (0 = disabled)

  # Threshold settings
  stale_project_days: 30             # Mark project stale after N days inactive
  activity_threshold_commits: 5      # Minimum commits for "active" status

  # Paths
  projects_file: ${PROJECTS_YML_PATH}

  # Logging
  log_level: INFO

# Consolidated hook configurations
# All hook-specific settings organized under hooks: section
hooks:
  # Logger hook - logs Claude Code events to structured JSON
  logger:
    log_base_path: .data/logs/claude_hooks
    log_enabled: true
    log_level: INFO

  # Playwright healer - self-healing for browser lock errors
  playwright_healer:
    log_base_path: .data/logs/playwright_healer
    log_enabled: true
    log_level: INFO
    max_recovery_attempts: 3
    recovery_cooldown_seconds: 5
    error_patterns:
      - "Browser is already in use"
      - "browser context is closed"
      - "Target page, context or browser has been closed"
      - "Browser has been closed"
      - "Connection closed"
    recoverable_tools:
      - mcp__playwright__browser_navigate
      - mcp__playwright__browser_snapshot
      - mcp__playwright__browser_click
      - mcp__playwright__browser_type
      - mcp__playwright__browser_evaluate

  # Rules loader - per-message rule reinforcement
  # Native Claude Code loads .claude/rules/*.md at session start
  # This hook optionally reinforces specific rules on every UserPromptSubmit
  rules_loader:
    reinforcement_enabled: false       # Global default for per-message injection
    rules_path: rules/                 # Source directory relative to .claude/
    # Per-rule reinforcement overrides
    # Rules not listed inherit global reinforcement_enabled value
    rules:
      000-rule-follower:
        reinforce: true                # Core directive compliance - always reinforce
      020-persona:
        reinforce: true                # Persona consistency
      030-agents:
        reinforce: true                # Agent usage reminder
      080-ask-user-questions:
        reinforce: true                # UX consistency
    # Logging config
    log_base_path: .data/logs/rules_loader
    log_enabled: true
    log_level: INFO

  # Session context settings (for session_context_injector hook)
  session_context:
    # Automatically invoke project-analysis agent on session start
    auto_invoke_agent: true
    # Analysis mode per session type
    # full = comprehensive analysis with all sections
    # abbreviated = focused on recent changes and pending work
    session_behavior:
      startup: full           # New session: full analysis
      resume: abbreviated     # --continue/--resume: abbreviated
      clear: full             # After /clear: full analysis
      compact: abbreviated    # After context compaction: abbreviated
    # Git context gathering settings
    git:
      commit_history_limit: 5   # Number of recent commits to include
    # Plans gathering settings
    plans:
      recent_limit: 3           # Number of recent plans to review

  # Changelog monitor - tracks Claude Code changelog updates
  changelog_monitor:
    enabled: true                 # Enable/disable changelog monitoring
    cache_ttl_hours: 24           # How long to cache changelog before refetching
    github_url: "https://raw.githubusercontent.com/anthropics/claude-code/main/CHANGELOG.md"
    roadmap_path: "docs/ROADMAP.md"
    notify_on_new_features: true  # Inject context about new features
    auto_update_roadmap: false    # Automatically update ROADMAP.md (requires explicit invocation)

  # Submodule auto-updater - automatic .claude submodule updates
  submodule_auto_updater:
    log_base_path: .data/logs/submodule_auto_updater
    log_enabled: true
    log_level: INFO
    check_interval_minutes: 15
